---
title: "Restaurant Event Dashboard"
output: flexdashboard::flex_dashboard
---

```{r setup, include = FALSE}
library(ggplot2)
library(dplyr)
library(tidyverse)
library(lubridate)
Perm_event <- read_csv("https://data.cityofnewyork.us/resource/tvpp-9vvx.csv")
Restaurant <- read_csv("https://data.cityofnewyork.us/resource/43nn-pn8j.csv")
knitr::opts_chunk$set(fig.width = 5, fig.asp = 1/3)
```

## Column 1

New York is one of the most popular and famous places in the world. Some of the many things the state is known for are its food and many activities. When looking for a place to live, these are important qualities that a person of any age would care about. Below, I have done the research for you. I am going to dive into the hard data behind New York's restaurant and events life with a little bit of my own person opinions being a current resident in NYC. With this data, I am going to provide detail into which of the five boroughs is best to live in depending on who you are! 

Lets get started by taking a look below at the average length of events which have taken place in each borough over the past few months. 

### Event Length

```{r}
Perm_events1 <- Perm_event%>%
  mutate(Perm_event,length_event_hr=hour(end_date_time)-hour(start_date_time),
         length_event_day=day(end_date_time)-day(start_date_time))
by_borough <- group_by(Perm_events1,event_borough)
avg_lengths <- summarise(by_borough,
                        count=n(),
                        length=mean(length_event_hr,na.rm = TRUE))
avg_lengths

ggplot(data=avg_lengths,mapping=aes(x=event_borough,y=length))+
  geom_point()+
  labs(title = "Longest average events take place in Brooklyn")

```

### Cuisine Options

```{r}
by_boroughs <- group_by(Restaurant,boro)
sum_cuisines <- summarise(by_boroughs,
                        count=n())
sum_cuisines
                        
ggplot(data=sum_cuisines,mapping=aes(x=boro,y=count))+
  geom_boxplot()+
  labs(title = "Most cuisine options are in Manhattan")
```

## Column 2

### Cuisine Description

```{r}
Perm_event_date <- Perm_event%>%
  separate(start_date_time, into = c("date","time"),sep = " ")%>%
  mutate(wday=wday(date,label = TRUE,abbr = FALSE))%>%
  select(event_name,date,wday,event_type,event_borough)

Perm_event_date

by_date <- group_by(Perm_event_date,event_borough,wday)
sum_date <- summarise(by_date,count=n())

sum_date%>%
  mutate(wday=recode_factor(wday,
                             Monday= "Weekday",
                             Tuesday= "Weekday",
                             Wednesday= "Weekday",
                            Thursday="Thursday",
                            Friday="Weekend",
                            Saturday="Weekend",
                            Sunday="Weekend"))


  
```

### Event Length 

```{r}
Perm_events1 <- Perm_event%>%
  mutate(Perm_event,length_event_hr=hour(end_date_time)-hour(start_date_time),
         length_event_day=day(end_date_time)-day(start_date_time))
Perm_events2 <- Perm_events1%>%
  mutate(Perm_events1,length_event_hr=hours(length_event_hr))
Perm_events2%>%
  select(event_borough,start_date_time,end_date_time,length_event_hr,length_event_day)%>%
  DT::datatable()
```
